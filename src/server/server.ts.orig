import express from 'express'
import ReactServer from 'react-dom/server'

import {createApp} from '../features/application'
import {createTemplate} from './basePage'
import { readMdFile } from './initialStateResolver';

const PORT = process.env.PORT || 3000

const server = express()
server.use(express.static('dist'))

<<<<<<< HEAD
server.get('/', (req, res) => {
  const body = ReactServer.renderToString(createApp())
=======
server.get('/', (req ,res) => {
  const md = readMdFile();
  const body = ReactServer.renderToString(createApp(md))
>>>>>>> 52e93f0be4a893d069ca994202b422a316c6a3e5
  const template = createTemplate({
    title: 'KisÃ¤llioppiminen.fi',
    body,
    initialState: md
  })

  res.send(template)
})

server.listen(PORT, () => {
  console.log('ðŸš€  Server now listening on ', PORT)
})
